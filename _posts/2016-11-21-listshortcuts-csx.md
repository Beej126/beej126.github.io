---
title: ListShortcuts.csx
author: Beej
type: post
date: 2016-11-22T05:54:08+00:00
year: "2016"
month: "2016/11"
url: /2016/11/listshortcuts-csx.html
snapEdIT:
  - 1
snapTW:
  - 's:162:"a:1:{i:0;a:6:{s:2:"do";s:1:"1";s:10:"SNAPformat";s:15:"%TITLE% - %URL%";s:8:"attchImg";s:1:"1";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:4:"doTW";s:1:"1";}}";'
dsq_thread_id:
  - 5529483311
categories:
tags:
  - CmdLine

---
    #r "Interop.IWshRuntimeLibrary.dll"
    //generated by referencing "Windows Script Host Object Model" in Visual Studio project
    
    
    //from here: https://stackoverflow.com/a/4909475/813599
    using IWshRuntimeLibrary;
    using System.Text.RegularExpressions;
    
    var wsh = new WshShell();
    
    var shortcutFileNames = System.IO.Directory.EnumerateFiles(Env.ScriptArgs[0], "*.lnk");
    var wshShortcuts = new Dictionary<String, IWshShortcut>();
    foreach (var shortcutFileName in shortcutFileNames)
      wshShortcuts[Regex.Match(shortcutFileName, ".*?- (.*?).lnk").Groups[1].Value] = (IWshShortcut)wsh.CreateShortcut(shortcutFileName);
    
    //var maxFileNameLength = wshShortcuts.Max(kv=>kv.Key.Length);
    
    Console.WriteLine("Display Name | Target | Arguments");
    Console.WriteLine("--- | --- | ---");
    foreach(var sc in wshShortcuts)
      Console.WriteLine($"{sc.Key} | {sc.Value.TargetPath} | {sc.Value.Arguments}");
    

### sample output

![image][1]

 [1]: https://cloud.githubusercontent.com/assets/6301228/20516333/f1d69564-b04a-11e6-96fe-f334306fc5b9.png